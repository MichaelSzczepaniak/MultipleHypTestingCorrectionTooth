---
title: "Tooth Growth Analysis"
author: "Michael Szczepaniak"
date: "September 2015"
output:
  html_document: 
    keep_md: yes
  pdf_document:
    fig_height: 3
    fig_width: 6
---

## Synopsis

This report explores the relationship between the length of teeth in 10 guinea pigs to three Vitimin C dosages and two delivery methods using the R ToothGrowth data set.  The data provided evidence that an increased mean tooth length was observed with increased dosage with both delivery methods under a Type II error rate $\alpha$ of 0.05.  The data also provided evidence that an increased mean tooth length was observed with the orange juice deliver method for the 0.5 and 1.0 mg doses under a Type II error rate $\alpha$ of 0.05.

## Loading Data & Exploratory Data Analysis
Note: All code used for the report are contained the **Code Used for the Analysis** section.

The *loadToothData* function was used to load the data.  This function was first passed to the *getToothSummary* to create the following summary table.  The **Group** variable concatinates the **Delivery** and **Dose** variables.

```{r echo=FALSE}
loadToothData <- function() {
    suppressMessages(suppressWarnings(require(dplyr)))
    library(datasets)
    library(dplyr)
    data("ToothGrowth")
    # rename variables/columns to make them clearer
    tooth.data <- rename(ToothGrowth, Length=len, Delivery=supp, Dose=dose)
    # add group id
    tooth.data <- mutate(tooth.data,
                         Group=factor(paste0(Delivery, sprintf("%.1f", Dose))))
    tooth.data <- mutate(tooth.data,  Dose = factor(Dose))
    return(tooth.data)
}

getToothSummary <- function(tooth.data = loadToothData()) {
    suppressMessages(suppressWarnings(library(dplyr)))
    suppressMessages(suppressWarnings(library(knitr)))
    library(dplyr)
    tooth.summ <- group_by(tooth.data, Group)
    tooth.table <- summarize(tooth.summ, Mean.Length = mean(Length),
                             Std.Dev.Length = sd(Length))
    library(knitr)
    kable(tooth.table, digits=2)
}

getToothSummary()
```

The *loadToothData* function was then passed to the *exploreBox* function to create the boxplot below.

```{r echo=FALSE}
loadToothData <- function() {
    suppressMessages(suppressWarnings(require(dplyr)))
    library(datasets)
    library(dplyr)
    data("ToothGrowth")
    # rename variables/columns to make them clearer
    tooth.data <- rename(ToothGrowth, Length=len, Delivery=supp, Dose=dose)
    # add group id
    tooth.data <- mutate(tooth.data,
                         Group=factor(paste0(Delivery, sprintf("%.1f", Dose))))
    tooth.data <- mutate(tooth.data,  Dose = factor(Dose))
    return(tooth.data)
}

exploreBox <- function(tooth.data = loadToothData()) {
    library(ggplot2)
    # exploratory panel plot
    p <- ggplot(tooth.data, aes(Dose, Length))
    p <- p + geom_boxplot()
    p <- p + facet_grid(Delivery ~ .)
    p <- p + xlab("Dose (milligrams)") + ylab("Length (units unknown)")
    p <- p + ggtitle("Effect of Vitamin C on Tooth Growth by Dose & Delivery Method")
    print(p)
}

exploreBox()
```
  
From this initial look at the data, three questions emerge to guide further exploration:

1. Does increased vitamin C dosage lead to an increase or decrease in tooth length?
2. Does vitamin C delivery method lead to an increase or decrease in tooth length?
3. Are the effects of dosage and delivery method on tooth length independent or coupled?

The plot above suggests a possible relationship between increasing dosage and tooth length for both delivery methods.  Dosage and delivery method were then explored by hypothesis testing.  The independence of the impact of dosage and delivery as stated in the third question above was not explored in this report.

## Analysis of the Data
Because the data does not contained ids for each animal, a paired analysis is not possible without assuming the data was ordered in a particular way.  For this reason, the analysis will focus on group comparisons.  The data contains 6 groups each with 10 measurments and are defined in the summary table.

To answer the first two questions, the null hypothesis was defined as $H_{0}: \mu_A = \mu_B$ (Mean A = Mean B in the testing table) and the alternative hypothesis as $H_{a}: \mu_B > \mu_A$ (Mean B > Mean A in the testing table) where A and B are the groups defined in the testing table (created by the function *createTestingTable*) shown below.

```{r echo=FALSE}
createTestingTable <- function(tooth.data = loadToothData()) {
    suppressMessages(suppressWarnings(library(dplyr)))
    suppressMessages(suppressWarnings(library(knitr)))
    library(dplyr)
    tooth.summ <- group_by(tooth.data, Group)
    tooth.table <- summarize(tooth.summ, Mean.Length = mean(Length),
                             Std.Dev.Length = sd(Length))
    df <- data.frame(Test=c("Addresses", "Group A", "Group B", "Mean A", "Mean B"),
                     t1=c("Question 1.", "OJ0.5", "OJ1.0",
                          as.character(tooth.table[1,2]),
                          as.character(tooth.table[2,2])),
                     t2=c("Question 1.", "OJ1.0", "OJ2.0",
                          as.character(tooth.table[2,2]),
                          as.character(tooth.table[3,2])),
                     t3=c("Question 1.", "VC0.5", "VC1.0",
                          as.character(tooth.table[4,2]),
                          as.character(tooth.table[5,2])),
                     t4=c("Question 1.", "VC1.0", "VC2.0",
                          as.character(tooth.table[5,2]),
                          as.character(tooth.table[6,2])),
                     t5=c("Question 2.", "VC0.5", "OJ0.5",
                          as.character(tooth.table[4,2]),
                          as.character(tooth.table[1,2])),
                     t6=c("Question 2.", "VC1.0", "OJ1.0",
                          as.character(tooth.table[5,2]),
                          as.character(tooth.table[2,2])),
                     t7=c("Question 2.", "VC2.0", "OJ2.0",
                          as.character(tooth.table[6,2]),
                          as.character(tooth.table[3,2])))
    library(knitr)
    kable(df, digits=2)
}

createTestingTable()
```


```{r}

```

## Hypothesis Testing
There are 7 testing scenarios that arise from this data set which can be described as follows:
  

The above is a table

```{r}

```



```{r}

```
## Assumptions & Conclusions

### Assumptions  
1. Variation between the populations tested were not equal.
2. Distribution of group means are not skewed (relatively symmetric) and mound-shaped.
3. The guineau pigs were IID normal in their selection.
4. The effects of dosage and delivery method on tooth length are independent.

### Conclusions
1. We reject $H_{0}$ in favor of $H_{a}$ for all tests except **t7**.
2. Based on 1., the evidence of the data supports the hypothesis that an increased mean tooth length will be observed with increased dosage with both delivery methods under a Type II error rate $\alpha$ of 0.05.
3. Also based on 1., the evidence of the data supports the hypothesis that an increased mean tooth length will be observed using the orange juice deliver method for the 0.5 and 1.0 mg dose levels under a Type II error rate $\alpha$ of 0.05.

\newpage

## Code Used for the Analysis

```{r eval=FALSE}
## Load the R ToothGrowth dataset and returns an updated data frame
loadToothData <- function() {
    suppressMessages(suppressWarnings(require(dplyr)))
    library(datasets)
    library(dplyr)
    data("ToothGrowth")
    # rename variables/columns to make them clearer
    tooth.data <- rename(ToothGrowth, Length=len, Delivery=supp, Dose=dose)
    # add group id
    tooth.data <- mutate(tooth.data,
                         Group=factor(paste0(Delivery, sprintf("%.1f", Dose))))
    tooth.data <- mutate(tooth.data,  Dose = factor(Dose))
    return(tooth.data)
}
## Summarizes the tooth data by group
getToothSummary <- function(tooth.data = loadToothData()) {
    suppressMessages(suppressWarnings(library(dplyr)))
    suppressMessages(suppressWarnings(library(knitr)))
    library(dplyr)
    tooth.summ <- group_by(tooth.data, Group)
    tooth.table <- summarize(tooth.summ, Mean.Length = mean(Length),
                             Std.Dev.Length = sd(Length))
    library(knitr)
    kable(tooth.table, digits=2)
}
## Creates the first explorator box plox of tooth length by dose and delivery
exploreBox <- function(tooth.data = loadToothData()) {
    library(ggplot2)
    # exploratory panel plot
    p <- ggplot(tooth.data, aes(Dose, Length))
    p <- p + geom_boxplot()
    p <- p + facet_grid(Delivery ~ .)
    p <- p + xlab("Dose (milligrams)") + ylab("Length (units unknown)")
    p <- p + ggtitle("Effect of Vitamin C on Tooth Growth by Dose & Delivery Method")
    print(p)
}
##
createTestingTable <- function(tooth.data = loadToothData()) {
    suppressMessages(suppressWarnings(library(dplyr)))
    suppressMessages(suppressWarnings(library(knitr)))
    library(dplyr)
    tooth.summ <- group_by(tooth.data, Group)
    tooth.table <- summarize(tooth.summ, Mean.Length = mean(Length),
                             Std.Dev.Length = sd(Length))
    df <- data.frame(Test=c("Addresses", "Group A", "Group B", "Mean A", "Mean B"),
                     t1=c("Question 1.", "OJ0.5", "OJ1.0",
                          as.character(tooth.table[1,2]),
                          as.character(tooth.table[2,2])),
                     t2=c("Question 1.", "OJ1.0", "OJ2.0",
                          as.character(tooth.table[2,2]),
                          as.character(tooth.table[3,2])),
                     t3=c("Question 1.", "VC0.5", "VC1.0",
                          as.character(tooth.table[4,2]),
                          as.character(tooth.table[5,2])),
                     t4=c("Question 1.", "VC1.0", "VC2.0",
                          as.character(tooth.table[5,2]),
                          as.character(tooth.table[6,2])),
                     t5=c("Question 2.", "VC0.5", "OJ0.5",
                          as.character(tooth.table[4,2]),
                          as.character(tooth.table[1,2])),
                     t6=c("Question 2.", "VC1.0", "OJ1.0",
                          as.character(tooth.table[5,2]),
                          as.character(tooth.table[2,2])),
                     t7=c("Question 2.", "VC2.0", "OJ2.0",
                          as.character(tooth.table[6,2]),
                          as.character(tooth.table[3,2])))
    library(knitr)
    kable(df, digits=2)
}
```